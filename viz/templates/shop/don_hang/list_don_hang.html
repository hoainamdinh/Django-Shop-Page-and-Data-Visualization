{% extends 'layout.html' %}
{% load humanize %}

{% block content %}
<h2 class="text-center mb-4">Danh Sách Đơn Hàng</h2>

<div class="text-center mb-4">
    <a class="btn btn-primary me-3" href="{% url 'viz:them_don_hang' %}">
        Thêm Đơn Hàng
    </a>
    <a class="btn btn-success" href="{% url 'viz:upload_don_hang' %}">
        Upload Đơn Hàng
    </a>
</div>

<!-- Pagination info -->
<div class="d-flex justify-content-between align-items-center mb-3">
    <span class="text-muted">
        Hiển thị {{ list_don_hang.start_index }} - {{ list_don_hang.end_index }} 
        trong tổng số {{ list_don_hang.paginator.count }} đơn hàng
    </span>
    <span class="badge bg-info">Trang {{ list_don_hang.number }} / {{ list_don_hang.paginator.num_pages }}</span>
</div>

<div class="table-responsive">
    <table class="table table-bordered table-striped">
        <thead >
            <tr>
                <th>Mã Đơn Hàng</th>
                <th>Thời Gian Tạo</th>
                <th>Khách Hàng</th>
                <th>Mặt Hàng</th>
                <th>SL</th>
                <th>Thành Tiền</th>
            </tr>
        </thead>
        <tbody>
            {% for don_hang in list_don_hang %}
            <tr>
                <td><code>{{ don_hang.ma_don_hang }}</code></td>
                <td>{{ don_hang.thoi_gian_tao_don|date:"d/m/Y H:i" }}</td>
                <td>{{ don_hang.khach_hang }}</td>
                <td>{{ don_hang.ten_mat_hang }}</td>
                <td><span>{{ don_hang.so_luong }}</span></td>
                <td><strong>{{ don_hang.thanh_tien|intcomma }} VND</strong></td>
                
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center text-muted">
                    <em>Chưa có đơn hàng nào</em>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination controls -->
<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if list_don_hang.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1">&laquo; Đầu</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ list_don_hang.previous_page_number }}">‹ Trước</a>
            </li>
        {% endif %}

        {% for num in list_don_hang.paginator.page_range %}
            {% if list_don_hang.number == num %}
                <li class="page-item active">
                    <span class="page-link">{{ num }}</span>
                </li>
            {% elif num > list_don_hang.number|add:'-3' and num < list_don_hang.number|add:'3' %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                </li>
            {% endif %}
        {% endfor %}

        {% if list_don_hang.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ list_don_hang.next_page_number }}">Sau ›</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ list_don_hang.paginator.num_pages }}">Cuối &raquo;</a>
            </li>
        {% endif %}
    </ul>
</nav>

{% endblock %}